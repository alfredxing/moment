var background = "#FFF",text = "#000",degrees = "",temp = "c",clock = "24",expires = "",weather = "",tform = "HMS",dform = "D M Y",lat, long;function recall() {		chrome.storage.sync.get(['background','text','temp','clock','tform','dform','expires','degrees','weather'], function(r) {		background = r['background'].toUpperCase() || "#FFF";		document.body.style.background = background;		text = r['text'].toUpperCase() || "#000";		document.body.style.color = text;		$(".wunderground").css("color",text);		tform = r['tform'] || "HMS";		dform = r['dform'] || "D M Y";		temp = r['temp'] || "c";		clock = r['clock'] || "24";		degrees = r['degrees'];		weather = r['weather'];		expires = r['expires'];		refresh();		getWeather();	});}function setExpires(a) {	chrome.storage.sync.set({expires:a}, function() {		console.log('Moment: expires saved');	});}function setDegrees(a) {	chrome.storage.sync.set({degrees:a}, function() {		console.log('Moment: degrees saved');	});}function setWeather(a) {	chrome.storage.sync.set({weather:a}, function() {		console.log('Moment: weather saved');	});}function request() {	var lat,long;	navigator.geolocation.getCurrentPosition(function(p) {		console.log(p);		lat = p.coords.latitude;		long = p.coords.longitude;		console.log("https://api.aerisapi.com/observations/closest?p="+lat+","+long+"&client_id=wgE96YE3scTQLKjnqiMsv&client_secret=sFA4Gfz8s8brxUUHoZTQ3iZIRy6YSwLhf1wJQzDi");		$.ajax({			url : "https://api.aerisapi.com/observations/closest?p="+lat+","+long+"&client_id=wgE96YE3scTQLKjnqiMsv&client_secret=sFA4Gfz8s8brxUUHoZTQ3iZIRy6YSwLhf1wJQzDi",			dataType : "jsonp",			success : function(r) {				var e = r.response[0].ob.weather;				if (temp.toUpperCase() === "F") {					var f = r.response[0].ob.tempF;				}				else {					var f = r.response[0].ob.tempC;				}				$("#degrees").text(f);				$("#weather").text(e);				$("#conditions").animate({opacity:1},300);				storeWeather(f, e)			}		});	});}/*function request() {	navigator.geolocation.getCurrentPosition(function(p) {		lat = p.coords.latitude;		long = p.coords.longitude;		$.ajax({			url : "https://api.wunderground.com/api/9202bf4aae6695aa/conditions/q/"+lat+","+long+".json",			dataType : "jsonp",			success : function(r) {				console.log(r);				var e = r.current_observation.weather;				if (temp.toUpperCase() === "F") {					var f = r.current_observation.temp_f;				}				else {					var f = r.current_observation.temp_c;				}				$("#degrees").text(f);				$("#weather").text(e);				$("#conditions").animate({opacity:1},300);				storeWeather(f, e)			}		});	});}*/function refresh() {	var v = new Date();	var p = v.getHours();	var q = v.getMinutes();	var t = v.getSeconds();	if (clock == "12" && p > 12) {		p = 24 - p;	}	if (10 > p) {		p = "0" + p	}	if (10 > q) {		q = "0" + q	}	if (10 > t) {		t = "0" + t	}	// var r = p + "" + q + "" + t;	var r = tform.replace("H",p).replace("M",q).replace("S",t);	var u = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];	var v = new Date();	var o = v.getMonth();	var n = u[o]; // month	var l = v.getDate(); // day	var m = v.getYear(); // year	if (m < 2000) {		m = m + 1900	}	// var s = n + " " + l + " " + m;	var s = dform.replace("D",l).replace("Y",m).replace("M",n);	$("#time").html(r);	$("#date").text(s);}function storeWeather(d,w) {	var a = new Date();	var c = a.getTime();	c += 60 * 1000;	a.setTime(c);	setDegrees(d);	setWeather(w);	setExpires(a.toGMTString());}function getWeather() {	var b = new Date();	var c = b;	var a = new Date(expires);	if ((a - c) > 0) {		$("#degrees").text(degrees);		$("#weather").text(weather);		$("#conditions").animate({opacity:1},300)	}	else {		request();	}}function load() {	recall();	interval = setInterval(function () {		refresh();	}, 1000);	$("body").animate({opacity:1},500);	$("body").click(function(){chrome.tabs.update({url:'chrome-internal://newtab/'});})}function install_notice() {	if (localStorage.getItem('install_time'))		return;	var now = new Date().getTime();	localStorage.setItem('install_time', now);	chrome.tabs.create({url: "options.html"});}install_notice();$(document).ready(function(){	refresh();	load();});