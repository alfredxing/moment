var prefs = Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions.moment.");var background = "#FFF",text = "#000",degrees = "",temp = "c",clock = "24",expires = "",weather = "",tform = "HMS",dform = "D M Y",loc = ":auto",interval;function recall() {		background = prefs.getCharPref("background");	document.body.style.background = background;	text = prefs.getCharPref("text").toUpperCase() || "#000";	document.body.style.color = text;	$(".wunderground").css("color",text);	tform = prefs.getCharPref("tform") || "HMS";	dform = prefs.getCharPref("dform") || "D M Y";	temp = prefs.getCharPref("temp") || "c";	clock = prefs.getCharPref("clock") || "24";	degrees = prefs.getCharPref("degrees");	weather = prefs.getCharPref("weather");	expires = prefs.getCharPref("expires");	loc = prefs.getCharPref("loc") || ":auto";	refresh();	getWeather();}function setExpires(a) {	prefs.setCharPref("expires", a);}function setDegrees(a) {	prefs.setCharPref("degrees", a);}function setWeather(a) {	prefs.setCharPref("weather", a);}function request() {	$.ajax({		url : "https://api.aerisapi.com/observations/closest?p="+loc+"&client_id=wgE96YE3scTQLKjnqiMsv&client_secret=sFA4Gfz8s8brxUUHoZTQ3iZIRy6YSwLhf1wJQzDi",		dataType : "jsonp",		success : function(r) {			var e = r.response[0].ob.weather;			if (temp.toUpperCase() === "F") {				var f = r.response[0].ob.tempF;			}			else {				var f = r.response[0].ob.tempC;			}			$("#degrees").text(f);			$("#weather").text(e);			$("#conditions").animate({opacity:1},300);			storeWeather(f, e)		}	});}function refresh() {	var v = new Date();	var p = v.getHours();	var q = v.getMinutes();	var t = v.getSeconds();	if (clock == "12" && p > 12) {		p = 24 - p;	}	if (10 > p) {		p = "0" + p	}	if (10 > q) {		q = "0" + q	}	if (10 > t) {		t = "0" + t	}	// var r = p + "" + q + "" + t;	var r = tform.replace("H",p).replace("M",q).replace("S",t);	var u = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];	var v = new Date();	var o = v.getMonth();	var n = u[o]; // month	var l = v.getDate(); // day	var m = v.getYear(); // year	if (m < 2000) {		m = m + 1900	}	// var s = n + " " + l + " " + m;	var s = dform.replace("D",l).replace("Y",m).replace("M",n);	$("#time").html(r);	$("#date").html(s);}function storeWeather(d,w) {	var a = new Date();	var c = a.getTime();	c += 60 * 1000;	a.setTime(c);	setDegrees(d);	setWeather(w);	setExpires(a.toGMTString());}function getWeather() {	var b = new Date();	var c = b;	var a = new Date(expires);	if ((a - c) > 0) {		$("#degrees").text(degrees);		$("#weather").text(weather);		$("#conditions").animate({opacity:1},300)	}	else {		request();	}}function load() {	recall();	interval = setInterval(function () {		refresh();	}, 1000);	$("body").animate({opacity:1},500);	// $("body").click(function(){chrome.tabs.update({url:'chrome-internal://newtab/'});})}function install_notice() {	if (localStorage.getItem('install_time'))		return;	var now = new Date().getTime();	localStorage.setItem('install_time', now);	chrome.tabs.create({url: "options.html"});}// install_notice();$(document).ready(function(){	refresh();	load();});