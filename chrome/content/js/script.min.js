var prefs=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions.moment.");var background="#FFF",text="#000",degrees="",temp="c",clock="24",expires="",weather="",tform="HMS",dform="D M Y",loc=":auto",font="100",zero="y",css="",interval;
function recall(){background=prefs.getCharPref("background");document.body.style.background=background;text=prefs.getCharPref("text").toUpperCase()||"#000";
document.body.style.color=text;$(".wunderground").css("color",text);tform=prefs.getCharPref("tform")||"HMS";dform=prefs.getCharPref("dform")||"D M Y";temp=prefs.getCharPref("temp")||"c";
clock=prefs.getCharPref("clock")||"24";degrees=prefs.getCharPref("degrees");weather=prefs.getCharPref("weather");expires=prefs.getCharPref("expires");loc=prefs.getCharPref("loc")||":auto";
font=prefs.getCharPref("font")||"100";zero=prefs.getCharPref("zero")||"y";css=prefs.getCharPref("css")||"";refresh();getWeather();}function setExpires(b){prefs.setCharPref("expires",b);
}function setDegrees(b){prefs.setCharPref("degrees",b);}function setWeather(b){prefs.setCharPref("weather",b);}function request(){$.ajax({url:"https://api.aerisapi.com/observations/closest?p="+loc+"&client_id=wgE96YE3scTQLKjnqiMsv&client_secret=sFA4Gfz8s8brxUUHoZTQ3iZIRy6YSwLhf1wJQzDi",dataType:"json",success:function(a){var c=a.response[0].ob.weather;
if(temp.toUpperCase()==="F"){var b=a.response[0].ob.tempF;}else{var b=a.response[0].ob.tempC;}$("#degrees").text(b);$("#weather").text(c);$("#conditions").animate({opacity:1},300);
storeWeather(b,c);}});}function refresh(){var h=new Date();var c=h.getHours();var b=h.getMinutes();var j=h.getSeconds();if(clock=="12"&&c>12){c=c-12;}if(10>c&&zero==="y"){c="0"+c;
}if(10>b){b="0"+b;}if(10>j){j="0"+j;}var a=tform.replace("H",c).replace("M",b).replace("S",j);var i=["January","February","March","April","May","June","July","August","September","October","November","December"];
var h=new Date();var d=h.getMonth();var e=i[d];var g=h.getDate();var f=h.getYear();if(f<2000){f=f+1900;}var k=dform.replace("D",g).replace("Y",f).replace("M",e);
$("#time").html(a);$("#date").html(k);}function storeWeather(f,e){var b=new Date();var g=b.getTime();g+=60*1000;b.setTime(g);setDegrees(f);setWeather(e);
setExpires(b.toGMTString());}function getWeather(){var d=new Date();var f=d;var e=new Date(expires);if((e-f)>0){$("#degrees").text(degrees);$("#weather").text(weather);
$("#conditions").animate({opacity:1},300);}else{request();}}function load(){recall();if(font==="100"){$("body, #date").css("font-weight","100");$("#conditions").css("font-weight","300");
}$("#custom").html(css);interval=setInterval(function(){refresh();},1000);$("body").animate({opacity:1},500);}function install_notice(){if(localStorage.getItem("install_time")){return;
}var a=new Date().getTime();localStorage.setItem("install_time",a);chrome.tabs.create({url:"options.html"});}$(document).ready(function(){refresh();load();
});